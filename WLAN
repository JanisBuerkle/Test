(netsh wlan show profiles) | Select-String "\:(.+)$" | %{$name=$_.Matches.Groups[1].Value.Trim(); $_} | %{(netsh wlan show profile name="$name" key=clear)} | Select-String "Schl√ºsselinhalt\W+\:(.+)$|Key Content\W+\:(.+)$" | %{$pass=$_.Matches.Groups[1].Value.Trim(); if (-not $pass) {$pass=$_.Matches.Groups[2].Value.Trim()}; $_} | %{[PSCustomObject]@{ PROFILE_NAME=$name;PASSWORD=$pass }} | Format-Table -AutoSize
